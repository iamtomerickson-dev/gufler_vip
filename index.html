<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gufler Mansion ‚Äî VIP Guest Loyalty</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Mono:wght@300;400;500&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --cream: #f5f0e8; --warm: #e8dcc8; --parchment: #d4c4a0;
    --brown: #3d2b1f; --dark: #1a0f0a; --rust: #9b3a1a;
    --gold: #c4953a; --sage: #5a7a5c; --muted: #7a6a5a;
    --rule: rgba(61,43,31,.18);
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'DM Sans', sans-serif; background: var(--cream); color: var(--dark); min-height: 100vh; }

  header {
    background: var(--brown); color: var(--cream);
    padding: 2.5rem 4rem 2rem; position: relative;
  }
  header::after {
    content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
  }
  .header-inner { max-width: 1100px; margin: 0 auto; }
  .eyebrow { font-family: 'DM Mono', monospace; font-size: .68rem; letter-spacing: .25em; text-transform: uppercase; color: var(--gold); margin-bottom: .5rem; }
  h1 { font-family: 'Playfair Display', serif; font-size: clamp(1.8rem, 3vw, 2.8rem); font-weight: 400; color: var(--cream); }
  h1 em { font-style: italic; color: var(--parchment); }
  .header-sub { font-size: .8rem; color: rgba(245,240,232,.6); margin-top: .4rem; font-family: 'DM Mono', monospace; }

  .main { max-width: 1100px; margin: 0 auto; padding: 2rem; }

  .intro {
    background: #fff; border: 1px solid var(--rule); border-radius: 2px;
    padding: 1.4rem 1.8rem; margin-bottom: 1.5rem;
    font-size: .85rem; line-height: 1.65; color: var(--brown);
    border-left: 4px solid var(--gold);
  }
  .intro strong { font-weight: 500; }

  .guest-grid { display: flex; flex-direction: column; gap: 1.2rem; }

  .guest-card {
    background: #fff; border: 1px solid var(--rule); border-radius: 2px;
    overflow: hidden; animation: fadeUp .5s ease both;
  }
  .guest-card:nth-child(1) { animation-delay: .05s; }
  .guest-card:nth-child(2) { animation-delay: .10s; }
  .guest-card:nth-child(3) { animation-delay: .15s; }
  .guest-card:nth-child(4) { animation-delay: .20s; }
  .guest-card:nth-child(5) { animation-delay: .25s; }
  .guest-card:nth-child(6) { animation-delay: .30s; }
  .guest-card:nth-child(7) { animation-delay: .35s; }
  .guest-card:nth-child(8) { animation-delay: .40s; }
  .guest-card:nth-child(9) { animation-delay: .45s; }

  .guest-header {
    display: flex; align-items: center; gap: 1.2rem;
    padding: 1.2rem 1.5rem; border-bottom: 1px solid var(--rule);
    cursor: pointer; user-select: none;
  }
  .guest-header:hover { background: var(--cream); }

  .rank-badge {
    font-family: 'Playfair Display', serif; font-style: italic;
    font-size: 1.6rem; color: var(--parchment);
    width: 36px; text-align: center; flex-shrink: 0;
  }
  .rank-badge.top { color: var(--gold); }

  .guest-identity { flex: 1; }
  .guest-name {
    font-family: 'Playfair Display', serif; font-size: 1.1rem;
    font-weight: 400; color: var(--brown);
  }
  .guest-name.anonymous { font-style: italic; color: var(--muted); }
  .guest-email {
    font-family: 'DM Mono', monospace; font-size: .7rem;
    color: var(--muted); margin-top: .15rem;
  }

  .visit-pills { display: flex; gap: .4rem; align-items: center; flex-shrink: 0; }
  .pill {
    width: 10px; height: 10px; border-radius: 50%;
    background: var(--brown);
  }
  .pill.faded { background: var(--warm); border: 1px solid var(--rule); }

  .visit-count {
    font-family: 'Playfair Display', serif; font-size: 1.8rem;
    color: var(--brown); line-height: 1; margin-left: .6rem;
  }
  .visit-label {
    font-family: 'DM Mono', monospace; font-size: .6rem;
    color: var(--muted); text-transform: uppercase; letter-spacing: .1em;
  }

  .chevron {
    color: var(--parchment); font-size: .9rem; flex-shrink: 0;
    transition: transform .2s;
  }
  .guest-card.open .chevron { transform: rotate(180deg); }

  .guest-detail {
    display: none; padding: 1.2rem 1.5rem;
    border-top: 1px solid var(--rule);
  }
  .guest-card.open .guest-detail { display: block; }

  .detail-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: .8rem; margin-bottom: 1rem;
  }
  .detail-item { }
  .detail-label {
    font-family: 'DM Mono', monospace; font-size: .6rem;
    text-transform: uppercase; letter-spacing: .12em; color: var(--muted);
    margin-bottom: .2rem;
  }
  .detail-value { font-size: .83rem; color: var(--brown); }
  .detail-value a { color: var(--rust); text-decoration: none; }
  .detail-value a:hover { text-decoration: underline; }

  .tag {
    display: inline-block; padding: .2rem .5rem;
    background: var(--warm); border-radius: 2px;
    font-family: 'DM Mono', monospace; font-size: .65rem;
    color: var(--brown); margin: .1rem;
  }
  .tag.alert { background: #fdf3e7; color: var(--rust); border: 1px solid #f0d4a0; }
  .tag.good  { background: #eaf2ea; color: var(--sage); border: 1px solid #c0d8c0; }

  .note {
    margin-top: .8rem; padding: .8rem 1rem;
    background: var(--cream); border-left: 3px solid var(--gold);
    font-size: .8rem; line-height: 1.6; color: var(--brown);
    border-radius: 0 2px 2px 0;
  }
  .note strong { font-weight: 500; }

  .action-btn {
    display: inline-block; margin-top: .8rem; margin-right: .5rem;
    padding: .45rem 1rem; border-radius: 2px;
    font-family: 'DM Mono', monospace; font-size: .7rem;
    text-decoration: none; cursor: pointer; border: none;
    letter-spacing: .05em;
  }
  .action-btn.primary { background: var(--brown); color: var(--cream); }
  .action-btn.primary:hover { background: var(--dark); }
  .action-btn.secondary { background: var(--warm); color: var(--brown); }
  .action-btn.secondary:hover { background: var(--parchment); }

  .section-head {
    font-family: 'DM Mono', monospace; font-size: .65rem;
    text-transform: uppercase; letter-spacing: .2em; color: var(--muted);
    margin: 2rem 0 .8rem; display: flex; align-items: center; gap: .6rem;
  }
  .section-head::after { content: ''; flex: 1; height: 1px; background: var(--rule); }

  footer { background: var(--dark); color: rgba(245,240,232,.4); font-family: 'DM Mono', monospace; font-size: .65rem; letter-spacing: .1em; text-align: center; padding: 1.2rem; margin-top: 2rem; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(12px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  @media (max-width: 700px) {
    header { padding: 2rem 1.2rem 1.5rem; }
    .main { padding: 1rem; }
    .guest-header { flex-wrap: wrap; }
  }
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <div class="eyebrow">Guest Loyalty Intelligence ¬∑ Emporia, Kansas</div>
    <h1>Gufler Mansion <em>‚Äî VIP &amp; Repeat Guests</em></h1>
    <div class="header-sub">9 repeat guests identified ¬∑ spanning 2017‚Äì2022 ¬∑ click any card to expand</div>
  </div>
</header>

<div class="main">

  <div class="intro">
    <strong>Why this matters:</strong> These 9 guests contacted the Gufler Mansion more than once ‚Äî making them the most valuable relationships in the database. The ESU coordinator alone drove 7 separate reservation threads. Two guests in the archive were turned away for Unbound Gravel weekend ‚Äî proof that the race fills the property beyond capacity. Each guest here warrants a personal outreach.
  </div>

  <div class="section-head">Institutional Partners</div>
  <div class="guest-grid" id="institutionalGuests"></div>

  <div class="section-head">Loyal Personal Guests</div>
  <div class="guest-grid" id="personalGuests"></div>

  <div class="section-head">Unbound Gravel ‚Äî Historical Demand</div>
  <div class="guest-grid" id="unboundGuests"></div>

</div>

<footer>Gufler Mansion Guest Intelligence ¬∑ VIP Loyalty Report ¬∑ 875 total records ¬∑ 9 repeat guests</footer>

<script>
const GUESTS = [
  {
    rank: 1,
    name: null,
    nameNote: 'ESU Coordinator (name not captured)',
    email: 'ktabare1@emporia.edu',
    phone: '(620) 341-5330',
    visits: 7,
    firstContact: '2018-12-10',
    lastContact: '2019-02-25',
    checkIn: '2018-12-06',
    room: null,
    type: 'institutional',
    tags: ['ESU', 'Institutional', 'Repeat Booker'],
    note: 'This is the most active single contact in the entire database ‚Äî 7 separate reservation threads for ESU candidate visits. The original contact is no longer at ESU. Use the directory link below to find the current coordinator for candidate visits and recruitment.',
    actionEmail: 'https://www.emporia.edu/about-emporia-state-university/leadership-faculty-staff/university-directory/',
    actionLabel: 'üîç Find current ESU contact',
  },
  {
    rank: 2,
    name: 'Laurie Pitman',
    email: 'kwerly@emporia.edu',
    phone: '(620) 341-6469',
    visits: 5,
    firstContact: '2019-10-04',
    lastContact: '2019-11-19',
    checkIn: '2019-10-22',
    checkOut: '2020-10-22',
    room: null,
    type: 'institutional',
    tags: ['ESU', 'Institutional', 'Dinner Booking'],
    note: 'Five reservation threads in a short window, including at least one dinner reservation. Susan\'s reply confirms availability and dinner accommodation. Another ESU-linked contact worth a direct outreach before fall recruitment season.',
  },
  {
    rank: 3,
    name: 'Marsha Telesmanic',
    email: 'mmhappier@msn.com',
    phone: '(602) 321-1801',
    visits: 3,
    firstContact: '2020-10-01',
    lastContact: '2022-01-17',
    checkIn: '2022-06-10',
    checkOut: '2022-06-15',
    room: 'Italian Room',
    type: 'personal',
    tags: ['Personal Guest', 'Arizona', 'Multi-night'],
    note: 'Marsha is the most loyal personal guest in the database ‚Äî three contacts spanning nearly two years, with a confirmed multi-night stay in the Italian Room in June 2022. She travels from the Phoenix area (602 area code). A warm personal note from Ben or Susan before summer 2025 could bring her back.',
  },
  {
    rank: 4,
    name: 'Rob Gilligan',
    email: 'gilligan_rob@yahoo.com',
    phone: null,
    visits: 3,
    firstContact: '2020-06-23',
    lastContact: '2020-06-24',
    checkIn: null,
    room: null,
    type: 'personal',
    tags: ['Personal Guest', 'Group Inquiry', 'Pricing Questions'],
    note: 'Three contacts in a very short window ‚Äî Rob was actively shopping for a group stay, asking about pricing for 6 guests / 3 couples. It\'s unclear if he ultimately booked. Worth a follow-up with group rate information for 2025.',
  },
  {
    rank: 5,
    name: 'Steve Cooper',
    email: 'steverotimicooper@gmail.com',
    phone: '(202) 830-1571',
    visits: 2,
    firstContact: '2017-08-30',
    lastContact: '2017-10-19',
    checkIn: '2017-08-29',
    room: null,
    type: 'personal',
    tags: ['Personal Guest', 'Washington DC', 'Early Guest'],
    note: 'One of the earliest guests in the database ‚Äî Steve\'s family stayed with us in August 2017, and he contacted us again in October that year. A Washington DC area guest who found the mansion during its earliest days.',
  },
  {
    rank: 6,
    name: 'Kaila Williams',
    email: 'kailaraewilliams@gmail.com',
    phone: '(785) 706-3990',
    visits: 2,
    firstContact: '2020-06-23',
    lastContact: '2020-06-24',
    checkIn: null,
    room: null,
    type: 'personal',
    tags: ['Personal Guest', 'Kansas', 'Group Inquiry'],
    note: 'Kaila inquired about group pricing alongside Rob Gilligan ‚Äî these may have been planning a joint stay at the Soaring Eagle property. Local Kansas guest worth re-engaging.',
  },
  {
    rank: 7,
    name: 'Kailyn Everitt',
    email: 'kailyneveritt@hotmail.com',
    phone: '(936) 648-8413',
    visits: 2,
    firstContact: '2020-06-23',
    lastContact: '2020-06-24',
    checkIn: '2021-03-01',
    checkOut: '2021-03-07',
    room: null,
    type: 'personal',
    tags: ['Personal Guest', 'Texas', 'Extended Stay'],
    note: 'Kailyn booked a 6-night stay in March 2021 ‚Äî one of the longer stays in the database. Texas guest who found us via the Soaring Eagle property in 2020.',
  },
  {
    rank: 8,
    name: null,
    nameNote: 'Guest (name not captured)',
    email: 'mtgraham11@gmail.com',
    phone: '(917) 916-0708',
    visits: 2,
    firstContact: '2020-10-30',
    lastContact: '2020-11-04',
    checkIn: '2021-06-07',
    room: null,
    type: 'unbound',
    tags: ['Unbound Gravel', 'Historical', 'New York', 'Build System'],
    note: 'Tried to book for Unbound Gravel and was turned away ‚Äî Susan\'s reply confirms the mansion was fully booked and redirected to Mouse Lake House. Reached out twice in one week. This record is evidence that Unbound Gravel fills the property and turns guests away. Use it to justify building a dedicated early-access list for future Unbound seasons.',
  },
  {
    rank: 9,
    name: null,
    nameNote: 'Guest (name not captured)',
    email: 'jenniferkroen@hotmail.com',
    phone: '(636) 515-5869',
    visits: 2,
    firstContact: '2020-11-17',
    lastContact: '2020-11-17',
    checkIn: '2021-06-04',
    checkOut: '2021-06-06',
    room: null,
    type: 'unbound',
    tags: ['Dirty Kanza', 'Historical', 'Missouri', 'Build System'],
    note: 'Turned away for the Dirty Kanza / Unbound weekend ‚Äî two contacts on the same day. Missouri guest (636 = St. Louis area). Another data point confirming that Unbound Gravel creates demand the property cannot currently capture. The action is building a system, not chasing old leads.',
  },
];

function makeVisitPips(count, max=7) {
  let html = '';
  for (let i = 0; i < max; i++) {
    html += `<div class="pill${i < count ? '' : ' faded'}"></div>`;
  }
  return html;
}

function renderGuest(g, container) {
  const card = document.createElement('div');
  card.className = 'guest-card';

  const displayName = g.name || g.nameNote;
  const isAnon = !g.name;

  card.innerHTML = `
    <div class="guest-header">
      <div class="rank-badge${g.rank <= 2 ? ' top' : ''}">${g.rank}</div>
      <div class="guest-identity">
        <div class="guest-name${isAnon ? ' anonymous' : ''}">${displayName}</div>
        <div class="guest-email">${g.email}</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:center;gap:.15rem">
        <div style="display:flex;gap:3px">${makeVisitPips(g.visits)}</div>
        <div style="display:flex;align-items:baseline;gap:.3rem">
          <div class="visit-count">${g.visits}</div>
          <div class="visit-label">contacts</div>
        </div>
      </div>
      <div class="chevron">‚ñæ</div>
    </div>
    <div class="guest-detail">
      <div class="detail-grid">
        <div class="detail-item">
          <div class="detail-label">Email</div>
          <div class="detail-value"><a href="mailto:${g.email}">${g.email}</a></div>
        </div>
        ${g.phone ? `<div class="detail-item">
          <div class="detail-label">Phone</div>
          <div class="detail-value"><a href="tel:${g.phone}">${g.phone}</a></div>
        </div>` : ''}
        <div class="detail-item">
          <div class="detail-label">First Contact</div>
          <div class="detail-value">${g.firstContact || '‚Äî'}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">Last Contact</div>
          <div class="detail-value">${g.lastContact || '‚Äî'}</div>
        </div>
        ${g.checkIn ? `<div class="detail-item">
          <div class="detail-label">Check-in</div>
          <div class="detail-value">${g.checkIn}</div>
        </div>` : ''}
        ${g.checkOut ? `<div class="detail-item">
          <div class="detail-label">Check-out</div>
          <div class="detail-value">${g.checkOut}</div>
        </div>` : ''}
        ${g.room ? `<div class="detail-item">
          <div class="detail-label">Room</div>
          <div class="detail-value">${g.room}</div>
        </div>` : ''}
      </div>
      <div>${g.tags.map(t => {
        const cls = ['Build System','Historical'].includes(t) ? '' : ['ESU','Institutional'].includes(t) ? 'good' : '';
        return `<span class="tag ${cls}">${t}</span>`;
      }).join('')}</div>
      <div class="note">${g.note}</div>
      ${g.actionLabel ? `<div><a class="action-btn primary" href="${g.actionEmail}">${g.actionLabel}</a></div>` : ''}
    </div>
  `;

  card.querySelector('.guest-header').addEventListener('click', () => {
    card.classList.toggle('open');
  });

  container.appendChild(card);
}

const institutional = document.getElementById('institutionalGuests');
const personal = document.getElementById('personalGuests');
const unbound = document.getElementById('unboundGuests');

GUESTS.forEach(g => {
  const target = g.type === 'institutional' ? institutional : g.type === 'unbound' ? unbound : personal;
  renderGuest(g, target);
});
</script>
</body>
</html>
